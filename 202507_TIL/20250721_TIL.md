# 25년 7월 21일


---


# 예외 처리의 중요성과 스프링에서의 구조적 처리 방식 학습, AOP를 통해 공통 로직을 모듈화하고 핵심 로직과 분리, 정적 리소스의 효율적인 제공과 캐싱 전략 학습

## 예외 처리

### 예외처리 이해하기

* **예외란?**: 프로그램 실행 중 발생하는 비정상적인 상황 (예: 파일 없음, 네트워크 오류 등)
* **체크 예외**: 반드시 처리해야 함 (예: FileNotFoundException)
* **언체크 예외**: 프로그래머의 실수로 발생 (예: NullPointerException)
* **예외처리 필요성**: 사용자에게 친절한 안내 제공, 시스템 안정성 향상
* **Spring MVC 예외 처리 흐름**: 컨트롤러 → DispatcherServlet → 예외 핸들러 → 사용자에게 응답

### 기본 예외 처리 방법

* **try-catch**: 예외 발생 가능 코드 감싸기
* **throws**: 예외 위임
* **@ExceptionHandler**: 특정 예외를 처리하는 메서드
* **@ControllerAdvice vs @RestControllerAdvice**

  * `@ControllerAdvice`: HTML 뷰 반환용
  * `@RestControllerAdvice`: JSON API 응답용

### 실무 패턴

* **ResponseEntity 사용**: 적절한 HTTP 상태 코드와 메시지 반환
* **비즈니스 vs 시스템 예외**

  * 비즈니스: 예측 가능, 400번대
  * 시스템: 예측 불가, 500번대
* **ErrorResponse DTO 설계**: code, message, timestamp, requestUrl, field errors 등 포함
* **로그 레벨 분류**

  * DEBUG, INFO, WARN, ERROR
* **예외 로깅 방식**: 슬랙 포맷처럼 {}로 메시지 작성, 예외는 마지막 인자로

### 예제 정리

* 사용자 정의 예외 `DuplicateEmailException` 정의
* 글로벌 예외 처리 `GlobalExceptionHandler`
* 로깅: @Slf4j 사용, 로그 레벨 구분
* HTTP 상태 코드 사용: 400, 404, 500 등

### 효과적인 예외 설계

* **사용자 정의 예외**: 도메인에 맞는 의미 있는 예외 설계
* **예외 계층 구조 설계**: 추상 클래스 기반으로 분류 (예: ShopException > PaymentException > PaymentFailedException 등)
* **다국어 메시지 처리**: messages\_ko.properties, messages\_en.properties
* **예외 로깅 전략**: 로그 레벨 구분 + 상세 데이터 포함

---

## AOP (Aspect-Oriented Programming)

### AOP 개념

* **목적**: 공통 관심사(로깅, 보안 등)를 핵심 로직에서 분리
* **주요 용어**

  * Aspect: 공통 기능 모듈
  * Join Point: Advice 적용 가능 지점
  * Advice: 수행할 작업
  * Pointcut: Advice 실행 기준

### AOP 사용 사례

* 로깅, 보안 검사, 트랜잭션 처리 등
* 코드 중복 제거, 유지보수 향상

### 스프링 AOP 사용법

* **@Aspect + @Component**: Aspect 클래스로 등록
* **Advice 종류**

  * @Before: 메서드 실행 전
  * @After: 실행 후
  * @AfterReturning: 정상 종료 후
  * @AfterThrowing: 예외 발생 시
  * @Around: 실행 전후 제어
* **Pointcut 예시**: `execution(* com.example.service.*.*(..))`

### 실전 예제

* `UserService`에서 사용자 정보 조회 및 관리자 작업 정의
* `LoggingAndSecurityAspect`에서 AOP로 실행 시간 측정 및 보안 검사
* `@Around`로 실행 시간 로그, `@Before`로 관리자 권한 체크
* `UserServiceTest`에서 테스트 시 `SecurityException` 발생 여부 확인

---

## 정적 리소스 관리

### 기본 정적 리소스 제공

* `src/main/resources/static` 아래의 파일들은 자동 서빙
* URL 예시: `/css/styles.css`, `/js/script.js`, `/images/logo.png`
* 정적 리소스 매핑 커스터마이징은 `WebMvcConfigurer`로 설정 가능

### 리소스 캐싱 및 버전 관리

* **브라우저 캐싱**: `application.yml`에서 캐시 기간 설정
* **파일 버전 관리**: content hashing 적용 (`?v=abc123`)
* **Thymeleaf**: `@{/css/styles.css}`처럼 사용하면 자동 버전 적용
* **개발 중 캐싱 끄기**: `cache.period: 0s`
* **배포 시 캐싱 기간 설정**: CSS/JS 1주\~1달, 이미지 6개월 이상

---


