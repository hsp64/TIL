# 25년 8월 24일


---

# SQL 복습


## 1. 관계형 기초 개념

* **관계형 데이터베이스(RDBMS)**: 행(row)·열(column) 구조의 테이블에 데이터를 저장.
* **스키마**: 테이블, 뷰, 인덱스, 프로시저 같은 객체들의 논리적 집합.
* **키(Key)**

  * 기본키(PK): 행을 유일하게 식별(중복·NULL 불가)
  * 후보키: 유일 식별 가능한 속성들의 집합
  * 대체키: 후보키 중 PK가 아닌 것
  * 외래키(FK): 다른 테이블의 PK/UK를 참조, 참조 무결성 보장
* **무결성 제약**: NOT NULL, CHECK, UNIQUE, PK, FK
* **정규화**

  * 1NF: 컬럼은 원자값만
  * 2NF: 부분 함수 종속 제거
  * 3NF: 이행 종속 제거
  * BCNF: 모든 결정자가 후보키
* **역정규화**: 성능 위해 중복 허용 (신중히)

---

## 2. SQL 문장 분류

* **DDL**: CREATE, ALTER, DROP, TRUNCATE (데이터 정의)
* **DML**: INSERT, UPDATE, DELETE (데이터 조작)
* **DQL**: SELECT (데이터 조회)
* **TCL**: COMMIT, ROLLBACK, SAVEPOINT (트랜잭션 제어)
* **DCL**: GRANT, REVOKE (권한 제어)

---

## 3. 데이터 타입 & NULL

* 숫자, 문자, 날짜/시간, 불리언, JSON 등 (DBMS마다 다름)
* **NULL**: 값 없음. `=`, `<>`로 비교 불가 → `IS NULL`, `IS NOT NULL` 사용.
* **NULL 관련 함수**:

  * `COALESCE(a, b, ...)`: 첫 번째 NULL 아닌 값 반환
  * `IFNULL(a, b)`: a가 NULL이면 b 반환
  * `NULLIF(a, b)`: a=b면 NULL 반환
* **COUNT 주의**: `COUNT(col)`은 NULL 제외, `COUNT(*)`는 모든 행 포함.
* **NOT IN 주의**: NULL 섞이면 결과 전체가 UNKNOWN → `NOT EXISTS` 권장.

---

## 4. SELECT 논리적 처리 순서

**FROM → WHERE → GROUP BY → HAVING → SELECT → DISTINCT → ORDER BY → LIMIT**

```sql
SELECT 컬럼/식/별칭
FROM 테이블/조인/서브쿼리
WHERE 행 필터링
GROUP BY 그룹핑
HAVING 그룹 조건
ORDER BY 정렬
LIMIT 페이징
```

---

## 5. JOIN 정리

* **INNER JOIN**: 매칭되는 행만
* **LEFT/RIGHT OUTER JOIN**: 한쪽은 유지, 못 맞춘 쪽은 NULL
* **FULL OUTER JOIN**: 일부 DB만 지원
* **CROSS JOIN**: 모든 조합
* **SELF JOIN**: 같은 테이블끼리 조인

> 주의: `LEFT JOIN` 후 `WHERE B.col = ...` 쓰면 INNER처럼 됨 → 조건은 가급적 `ON`에 두기.

예시: 모임별 승인된 참여자 수

```sql
SELECT m.meeting_id, m.title,
       COUNT(*) AS approved_count
FROM   meeting m
LEFT JOIN meeting_participant mp
       ON mp.meeting_id = m.meeting_id
      AND mp.status = 'APPROVED'
GROUP BY m.meeting_id, m.title
ORDER BY approved_count DESC;
```

---

## 6. 집계 & 윈도우 함수

* **집계 함수**: `COUNT`, `SUM`, `AVG`, `MIN`, `MAX`
* **HAVING**: 그룹 조건 필터링
* **윈도우 함수 (OVER)**: 행 유지하면서 그룹 계산

  * 순위: `ROW_NUMBER`, `RANK`, `DENSE_RANK`
  * 누적합: `SUM(col) OVER (PARTITION BY ... ORDER BY ...)`

---

✅ 여기까지가 SQL 기본기 + SQLD 시험에 꼭 나오는 핵심 요약.
