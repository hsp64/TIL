# 25년 8월 7일


---


# JWT 인증 기반 로그인/회원가입 기능 구현 및 프론트엔드 모듈화(JS 모듈, 공통 유틸, API 서비스) 적용

## 🚀 오늘 배운 내용

- 사용자 인증 시스템의 핵심인 JWT(Json Web Token) 인증 기능을 추가하고, 로그인 API의 응답 구조를 개선했습니다. 
- 또한, 프론트엔드에서는 페이지 렌더링을 위한 컨트롤러와 뷰를 구현하고, JavaScript 코드의 모듈화를 통해 코드의 재사용성과 유지보수성을 높이는 작업을 진행했습니다. 
- 마지막으로, 공통으로 사용될 유틸리티 함수와 API 요청 서비스를 별도의 모듈로 분리하여 효율적인 개발 환경을 구축했습니다.

---

### 1. JWT 인증 기능 추가 JWT(Json Web Token)는 웹표준(RFC 7519)으로서, 두 개체 사이에서 JSON 객체를 사용하여 가볍고 자가수용적인 방식으로 정보를 안전하게 전송하기 위한 방법입니다.

*   **`build.gradle`에 `jjwt` 의존성 추가**: JWT를 생성하고 검증하기 위해 `io.jsonwebtoken:jjwt` 라이브러리를 프로젝트에 추가했습니다. 최신 버전 사용이 권장되지만, JDK 버전에 따라 호환되는 버전을 선택해야 합니다.
*   **`JwtProvider`, `JwtProperties` 클래스 구현**:
    *   `JwtProvider`: 토큰 생성, 유효성 검증, 정보 추출 등의 JWT 관련 핵심 로직을 담당하는 클래스입니다.
    *   `JwtProperties`: JWT와 관련된 설정값(비밀키, 만료 시간 등)을 `application.yml` 파일로부터 읽어와 관리하는 클래스입니다.
*   **비밀키 생성 및 테스트**: HMAC-SHA 알고리즘을 사용하기 때문에 256비트 이상의 안전한 비밀키를 생성하고, 이를 사용하여 토큰이 정상적으로 암호화 및 복호화되는지 테스트를 통해 확인했습니다.
*   **`application.yml`에 JWT 설정 추가**: `jwt.secret-key`, `jwt.expiration-time` 등의 프로퍼티를 추가하여 JWT 설정을 외부에서 관리하도록 구성했습니다.

### 2. 로그인 API 응답 개선

*   **`AuthResponse` DTO 추가**: 기존에 단순히 성공/실패 여부만 반환하던 로그인 API에서, 인증 성공 시 생성된 JWT 토큰을 담아 클라이언트에 전달하기 위한 `AuthResponse` DTO(Data Transfer Object)를 추가했습니다.
*   **JWT 토큰 반환 로직 구현**: `UserService`의 `authenticate` 메서드에서 사용자 인증 성공 시, `JwtProvider`를 통해 Access Token을 생성하고 `AuthResponse`에 담아 반환하도록 로직을 업데이트했습니다.
*   **`AuthController` 수정**: `AuthController`의 로그인 API가 `AuthResponse` DTO를 사용하여 JWT 토큰을 포함한 응답 데이터를 클라이언트에 최종적으로 반환하도록 수정했습니다.

### 3. 페이지 렌더링을 위한 컨트롤러 및 뷰 구현

*   **`PageController` 생성**: 사용자의 요청에 따라 적절한 HTML 페이지를 렌더링하는 `PageController`를 구현했습니다.
*   **HTML 파일 추가 및 수정**:
    *   `index.html`: 메인 페이지
    *   `login.html`: 로그인 폼을 포함하는 페이지
    *   `signup.html`: 회원가입 폼을 포함하는 페이지
*   **`signup.css` 추가**: 회원가입 페이지의 스타일을 정의하기 위한 CSS 파일을 추가했습니다.

### 4. JS 모듈화 작업 완료

*   **`App.js` 파일 구현**:
    *   `getCurrentPage`: 현재 URL을 기반으로 어떤 페이지에 있는지 식별하는 함수를 구현했습니다. 이를 통해 각 페이지에 맞는 JavaScript 모듈을 동적으로 로드할 수 있습니다.
*   **페이지별 JS 파일 추가**:
    *   `signup.js`: 회원가입 관련 JavaScript 로직을 담는 모듈
    *   `login.js`: 로그인 관련 JavaScript 로직을 담는 모듈

### 5. 페이지별 JS 모듈 로드 기능 추가

*   **`App.js`에 dynamic import 로직 구현**: `import()` 표현식을 사용하여 필요한 시점에 모듈을 동적으로 로드하는 기능을 구현했습니다. 이는 초기 페이지 로딩 속도를 향상시키는 데 도움이 됩니다.
*   **페이지 모듈 초기화(init) 및 오류 핸들링**: 동적으로 로드된 각 페이지 모듈의 `init` 메서드를 호출하여 해당 페이지에 필요한 기능을 초기화하고, 모듈 로드 과정에서 발생할 수 있는 오류를 처리하는 로직을 추가했습니다.
*   **`signup.js`와 `login.js` 수정**: 각 모듈이 `init` 메서드를 반환하도록 구조를 변경하여, `App.js`에서 일관된 방식으로 모듈을 초기화할 수 있도록 했습니다.

### 6. Signup.js 초기화 로직 개선 및 head.html 스크립트 모듈화

*   **회원가입 JS(`signup.js`) 초기화 로직 개선**:
    *   `state` 객체를 추가하여 회원가입 폼의 상태를 관리합니다.
    *   주요 DOM 요소를 변수로 캐싱하여 성능을 최적화했습니다.
    *   `handleSubmit` (폼 제출 핸들러) 및 `bindEvents` (이벤트 바인딩) 로직을 구현하여 코드의 구조를 명확히 했습니다.
*   **`head.html` 스크립트 모듈화**: `app.js`를 로드하는 `<script>` 태그에 `type="module"` 속성을 추가하여, ES6 모듈 시스템을 사용하도록 설정했습니다. 이를 통해 모듈 스코프를 가지게 되어 전역 변수 충돌을 방지할 수 있습니다.

### 7. 공통 유틸리티 및 API 서비스 모듈 추가

*   **`util.js`**: 여러 곳에서 공통으로 사용될 함수들을 모듈로 분리했습니다.
    *   `showMessage`: 사용자에게 메시지를 보여주는 함수
    *   `validateForm`: 폼 입력 값의 유효성을 검사하는 함수
    *   `setLoadingState`: 비동기 처리 중 버튼을 비활성화하고 로딩 상태를 표시하는 함수
    *   `redirectTo`: 특정 페이지로 이동시키는 함수
    *   `debounce`: 연속적인 이벤트 발생 시 마지막 이벤트만 처리하도록 하는 디바운스 함수
*   **`api.js`**: 서버 API 요청을 보다 쉽게 처리하기 위한 공통 서비스 모듈을 구현했습니다.
    *   `request`: fetch API를 기반으로 한 공통 요청 함수
    *   HTTP 메서드(GET, POST, PUT, DELETE)별 요청 함수를 구현하여 코드의 가독성과 재사용성을 높였습니다.
*   **`signup.js`에 `util.js` 및 `api.js` 적용**: 회원가입 폼 제출 시, `util.js`의 `validateForm` 함수로 폼 데이터를 검증하고, `api.js`의 `post` 함수를 사용하여 서버에 회원가입을 요청합니다. 요청 결과에 따라 `showMessage` 함수로 성공 또는 실패 메시지를 사용자에게 보여주고, 성공 시 `redirectTo` 함수를 통해 로그인 페이지로 이동시킵니다.
