# 25년 8월 5일


---


# Spring Security 인증과 인가, SQL 관리 구문 TCL과 DCL

## Spring Security 인증과 인가

스프링 시큐리티는 스프링 기반의 애플리케이션 보안(인증, 인가 등)을 담당하는 프레임워크입니다. 보안 관련 기능을 표준화하고 자동화하여 개발자가 핵심 비즈니스 로직에 더 집중할 수 있도록 돕습니다.

### 1. 인증 (Authentication)

**인증은 사용자의 신원을 확인하는 과정입니다.** 즉, "누구인지"를 증명하는 절차입니다. 웹 서비스에서 아이디와 비밀번호를 입력하여 로그인하는 행위가 가장 대표적인 인증의 예입니다.

**스프링 시큐리티에서의 인증 과정:**

1.  사용자가 아이디와 비밀번호로 로그인을 시도합니다.
2.  `AuthenticationFilter`가 `HttpServletRequest`에서 사용자가 입력한 아이디와 비밀번호를 가로채 `UsernamePasswordAuthenticationToken`을 생성합니다.
3.  생성된 토큰은 `AuthenticationManager`에게 전달됩니다.
4.  `AuthenticationManager`는 등록된 `AuthenticationProvider`들에게 인증을 위임합니다.
5.  `AuthenticationProvider`는 `UserDetailsService`를 통해 데이터베이스 등에서 사용자 정보를 조회합니다.
6.  조회된 사용자 정보의 비밀번호와 사용자가 입력한 비밀번호를 비교하여 인증을 수행합니다.
7.  인증에 성공하면 사용자 정보를 담은 `Authentication` 객체를 생성하고 `SecurityContext`에 저장합니다.

### 2. 인가 (Authorization)

**인가는 인증된 사용자가 특정 리소스에 접근할 수 있는 권한이 있는지 확인하는 과정입니다.** 즉, "무엇을 할 수 있는지"를 결정하는 절차입니다. 예를 들어, 일반 사용자는 관리자 페이지(`'/admin/**'`)에 접근할 수 없도록 막는 것이 인가에 해당합니다.

**스프링 시큐리티에서의 인가 과정:**

1.  인증된 사용자가 특정 URL에 접근을 시도합니다.
2.  `FilterSecurityInterceptor`가 해당 요청을 가로채 접근 권한을 확인합니다.
3.  `SecurityContext`에 저장된 `Authentication` 객체에서 사용자의 권한(Role) 정보를 가져옵니다.
4.  사용자가 가진 권한과 해당 리소스에 접근하기 위해 필요한 권한을 비교합니다.
5.  권한이 충분하면 접근을 허용하고, 그렇지 않으면 접근을 거부합니다.

### 3. 인증과 인가의 핵심 차이

| 구분 | 인증 (Authentication) | 인가 (Authorization) |
| --- | --- | --- |
| **의미** | "누구인지" 확인 (신원 확인) | "무엇을 할 수 있는지" 확인 (권한 부여) |
| **시점** | 인가보다 먼저 수행됨 | 인증 후에 수행됨 |
| **결과** | 인증 성공 또는 실패 | 접근 허용 또는 거부 |
| **예시** | 로그인 | 관리자 페이지 접근 제어 |

## SQL 관리 구문 TCL과 DCL

SQL 명령어는 기능에 따라 데이터 정의 언어(DDL), 데이터 조작 언어(DML), 데이터 제어 언어(DCL), 트랜잭션 제어 언어(TCL) 등으로 나뉩니다.

### 1. TCL (Transaction Control Language, 트랜잭션 제어어)

TCL은 데이터베이스의 논리적인 작업 단위인 트랜잭션을 제어하는 데 사용되는 명령어입니다. 트랜잭션은 여러 SQL 명령문들을 하나의 논리적인 작업 단위로 묶은 것으로, 데이터의 일관성과 무결성을 보장하는 데 중요한 역할을 합니다.

*   **`COMMIT`**: 모든 작업을 정상적으로 처리했음을 확정하고, 변경된 내용을 데이터베이스에 영구적으로 저장합니다.
*   **`ROLLBACK`**: 작업 중 문제가 발생했을 때, 트랜잭션 내에서 수행된 모든 작업을 취소하고 마지막 `COMMIT` 시점의 상태로 되돌립니다.
*   **`SAVEPOINT`**: 트랜잭션 내에 임시 저장 지점을 만들어, `ROLLBACK` 할 때 전체 트랜잭션을 취소하는 대신 특정 `SAVEPOINT`까지의 일부 작업만 취소할 수 있도록 합니다.

**예시:**

```sql
START TRANSACTION; -- 트랜잭션 시작

INSERT INTO users (id, name) VALUES (1, '홍길동');
SAVEPOINT sp1; -- 세이브포인트 설정

UPDATE users SET name = '김철수' WHERE id = 1;

ROLLBACK TO sp1; -- sp1 세이브포인트로 롤백 (UPDATE 문 취소)

COMMIT; -- 트랜잭션 종료 및 확정 (INSERT 문은 반영됨)
```

### 2. DCL (Data Control Language, 데이터 제어어)

DCL은 데이터베이스 사용자에게 권한을 부여(GRANT)하거나 회수(REVOKE)하는 등 데이터에 대한 접근을 제어하는 데 사용되는 명령어입니다. 이를 통해 데이터베이스의 보안을 강화하고 데이터의 무결성을 유지할 수 있습니다.

*   **`GRANT`**: 특정 사용자에게 테이블 생성, 데이터 조회, 수정, 삭제 등의 특정 작업을 수행할 수 있는 권한을 부여합니다.

    **예시:** `user1`에게 `employees` 테이블의 데이터를 조회할 수 있는 권한 부여
    ```sql
    GRANT SELECT ON employees TO user1;
    ```

*   **`REVOKE`**: 사용자에게 부여했던 권한을 회수합니다.

    **예시:** `user1`에게 부여했던 `employees` 테이블의 조회 권한 회수
    ```sql
    REVOKE SELECT ON employees FROM user1;
    ```
