# 25년 8월 12일


---

# 백엔드- 엔터티 및 데이터베이스 설계, QueryDSL을 활용한 동적 쿼리 구현, 테스트 코드 작성 및 환경 개선, 프론트엔드 - 화면 구현, 공통 모듈 및 라우팅 시스템 구축

오늘은 여행 정보 관리 시스템의 백엔드와 프론트엔드 구조를 구축하고 고도화하는 작업을 진행했습니다. 주요 변경 사항은 엔터티 설계, 동적 쿼리 구현, 테스트 코드 작성, 프론트엔드 화면 및 공통 모듈 개발입니다.

## 1. 백엔드 (Backend)

### 1.1. 엔터티 및 데이터베이스 설계
- **`Trip` 및 `TripStatus` 엔터티 추가**: 여행의 핵심 데이터를 관리하기 위한 `Trip` 엔터티를 설계했습니다.
  - **주요 필드**: 제목, 설명, 예산, 목적지, 여행 시작일 및 종료일, 상태(`TripStatus`) 등을 포함합니다.
  - **관계 매핑**: 사용자와 다대일(`@ManyToOne`) 관계로 매핑하여 특정 유저의 여행 정보를 관리합니다.
  - **자동 시간 관리**: `@CreationTimestamp`와 `@UpdateTimestamp`를 사용하여 데이터 생성 및 수정 시각을 자동으로 기록하도록 설정했습니다.
  - **상태 관리**: 여행의 상태를 `계획중`, `진행중`, `완료`, `취소`로 명확하게 구분하기 위해 `TripStatus` 열거형(Enum)을 추가했습니다.
- **비즈니스 로직 추가**: `Trip` 엔터티 내에 정보 수정, 기간 계산, 상태 확인 등 간단한 비즈니스 메서드를 포함하여 객체의 역할을 강화했습니다.
- **Hibernate 설정**: `application.yml` 파일에서 `ddl-auto` 옵션을 `create` 또는 `update`로 변경하며 개발 환경에 맞게 데이터베이스 스키마를 유연하게 관리하는 방법을 익혔습니다.

### 1.2. QueryDSL을 활용한 동적 쿼리 구현
- **QueryDSL 도입**: 복잡하고 동적인 검색 요구사항을 효과적으로 처리하기 위해 QueryDSL을 프로젝트에 도입했습니다.
  - **설정**: `build.gradle`에 `querydsl-jpa`와 `querydsl-apt` 의존성을 추가하고, `JPAQueryFactory`를 Spring Bean으로 등록하는 `QueryDslConfig`를 작성했습니다.
- **커스텀 리포지토리 구현**:
  - `TripRepository`에 `TripRepositoryCustom` 인터페이스를 상속받도록 하여 기본 CRUD 외의 확장 기능을 분리했습니다.
  - `TripRepositoryImpl` 구현체에서 `JPAQueryFactory`를 사용하여 동적 쿼리를 작성했습니다.
- **동적 검색 기능**:
  - `TripSearchCondition` 클래스를 생성하여 여행 상태, 목적지, 제목 등 다양한 검색 조건을 캡슐화했습니다.
  - `BooleanExpression`을 활용하여 검색 조건의 유무에 따라 동적으로 `WHERE` 절을 생성하고, `orderBy`를 통해 정렬 로직을 구현했습니다. 이를 통해 페이징 처리를 포함한 유연한 데이터 조회가 가능해졌습니다.
- **메서드 리팩토링**: `findTripsByUser` 메서드의 이름을 `getTripList`로 변경하여 역할을 더 명확하게 표현하도록 개선했습니다.

### 1.3. 테스트 코드 작성 및 환경 개선
- **`TripRepository` 테스트**: `TripRepositoryTest`를 작성하여 데이터베이스와의 상호작용을 검증했습니다.
  - 사용자별 여행 목록 조회, 페이징 기능, 여행 상태 변경(`updateTripsStatus`) 로직을 테스트했습니다.
- **테스트 환경 통합**:
  - 기존 `@DataJpaTest` 어노테이션을 `@SpringBootTest`로 변경하여 실제 운영 환경과 유사한 통합 테스트 환경을 구축했습니다.
  - `@Rollback(false)`와 `@Transactional`을 함께 사용하여 테스트 실행 후 데이터베이스에 결과가 반영되는지 직접 확인하는 방법을 적용했습니다.
- **엔터티 디버깅**: `Trip` 엔터티에 `@ToString(exclude = "user")`를 추가하여 양방향 연관관계에서 발생할 수 있는 순환 참조 문제를 방지하고 로그 확인을 용이하게 만들었습니다.

## 2. 프론트엔드 (Frontend)

### 2.1. 화면 구현
- **대시보드**: 사용자의 기본 정보, 여행 통계, 최근 여행 목록 등을 보여주는 메인 대시보드 화면을 구현했습니다.
- **여행 목록**: 여행 데이터를 동적으로 렌더링하고, 상태(계획중, 완료 등)에 따라 다른 UI를 표시하며, 필터링 및 검색 기능을 제공하는 여행 목록 화면을 추가했습니다.

### 2.2. 공통 모듈 및 라우팅 시스템 구축
- **공통 유틸리티 `common.js`**: 여러 페이지에서 재사용될 수 있는 기능들을 모듈화했습니다.
  - **주요 기능**: 사용자 인증 상태 확인(`isAuthenticated`), 알림(Toast/Alert), UI 요소 제어, 날짜 포맷팅 등
- **동적 라우팅 시스템**:
  - `routes-config.js`: 각 URL 경로에 필요한 JavaScript 모듈과 인증 여부를 정의하는 설정 파일을 추가했습니다.
  - `app.js`: 페이지 진입 시 현재 경로를 확인하고, `routes-config.js` 설정에 따라 필요한 모듈을 동적으로 로딩하며, 인증이 필요한 페이지에 대한 접근을 제어하는 라우트 가드(Route Guard) 로직을 구현했습니다. 이를 통해 페이지별 초기화 및 접근 제어를 체계적으로 관리할 수 있게 되었습니다.
